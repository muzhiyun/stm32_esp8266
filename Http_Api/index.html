<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
	<style type="text/css">
	body, html,#allmap {width: 100%;height: 100%;overflow: hidden;margin:0;font-family:"微软雅黑";}
	</style>
	<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=vV22rRRBUQAtmYTEzP1eBrKSABDNXGGN"></script>
	<title>MuZhi</title>

<script src="https://cdn.staticfile.org/jquery/3.4.0/jquery.min.js"></script>

<script>

</script>

</head>
<body>
	<div id="allmap"></div>
	<div id="div1"></div>

</body>
</html>



<script type="text/javascript">

	// 百度地图API功能
	var map = new BMap.Map("allmap",{mapType: BMAP_HYBRID_MAP});    // 创建Map实例
	map.centerAndZoom("西安",15);      // 初始化地图,用城市名设置地图中心点
	//map.centerAndZoom(new BMap.Point(116.404, 39.915), 11);  // 初始化地图,设置中心点坐标和地图级别
	//添加地图类型控件
	/*map.addControl(new BMap.MapTypeControl({
		mapTypes:[
            BMAP_NORMAL_MAP,
            BMAP_HYBRID_MAP
        ]}));	*/  
	//map.setCurrentCity("重庆");          // 设置地图显示的城市 此项是必须设置的
	map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放


var jsonobj;
page_num={};
//$(document).ready(function(){

	//$.ajax({url:"data.json",dataType:"json"});

	$.ajax({

　　　　url : 'http://*.*.*.*/test/echo.php', 　   //<!-- url  :请求地址 -->  
　　　　type : 'get',　　　　　　　　//<!--type ：请求类型:post/get --> 
　　　　data : {　　　　　　　　　　　//<!--data ：发送给服务器的数据 -->      
	　　　　　　　　password:"yiban"
				//uUsername : u,　　　　　//　  <!-- 使用自己声明的对象 -->  
　　　　　　　　//uPwd : $("#pwd").val()　//　　 <! -- 直接获取页面的对象 -->  
　　　　　　},
　　　　dataType : 'json',           //         <!--dataType:服务器返回的数据类型 text/xml/script/html/json/jsonp -->
　　　　success: function(data){　　　//<!---回调函数 --> 

　　　　　　//console.log(data);          //   <! -- 浏览器控制台显示返回内容（建议使用） -->
			//var obj = JSON.parse(data);
			page_num = data;
			handle();
			//for (var i = 0; i < data.length; i++) {
        //result[i]表示获得第i个json对象即JSONObject
        //result[i]通过.字段名称即可获得指定字段的值
       
    		//}
　　　　　　//alert(obj);　　　　　　     //<! -- 弹框显示返回内容 -->
　　　　　　}

　　　　});

    /*$("#div1").load("data.json",function(responseTxt,statusTxt,xhr){
      if(statusTxt=="success")
        alert("外部内容加载成功!");
      if(statusTxt=="error")
        alert("Error: "+xhr.status+": "+xhr.statusText);
});*/
//});



	function addMarker(point,mess,link){
	  var marker = new BMap.Marker(point);
	  //onsole.log("start");
	  map.addOverlay(marker);

	var infoWindow = new BMap.InfoWindow("id:"+mess+"</br>详情:<a href=\"http://*.*.*.*/test"+link+"\">点我查看</a></br>预览:<img style='float:center;margin:4px' id='imgDemo' src='http://*.*.*.*/test"+link+"' width='139' height='104' title='缩略图'/>");  // 创建信息窗口对象 
	marker.addEventListener("click", function(){          
		map.openInfoWindow(infoWindow,point); //开启信息窗口
	});
	}


	// var bounds = map.getBounds();
	// var sw = bounds.getSouthWest();
	// var ne = bounds.getNorthEast();
	function handle(){
	for (var i = 0; i < page_num.length; i++) {
	var point = new BMap.Point(page_num[i].x, page_num[i].y);
	 //console.log(page_num[i].time);
	addMarker(point,page_num[i].id,page_num[i].path);

}
}
</script>